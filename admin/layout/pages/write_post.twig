{% extends "layout.twig" %}

{% block title %}${ "Write" | translate }{% endblock %}

{% block subnav %}
			<li class="right">${ "Bookmarklet: %s" | translate | format('<a href="' ~ bookmarklet ~ '">Chyrp!</a>') }</li>
			{% for feather in site.enabled_feathers %}
			<li{% if GET.feather == feather %} class="selected"{% endif %}><a href="{% admin "write_post&feather="~feather %}">${ feather | capitalize }</a></li>
			{% endfor %}
			<li><a href="{% admin "write_page" %}">${ "Page" | translate }</a></li>
{% endblock %}

{% block content %}
			<h1>Add ${ feather | capitalize }</h1>
			<form action="{% admin "add_post" %}" method="post" accept-charset="utf-8">
				{% for field in featherTEMP.fields %}
				<p>
					<label for="$field.attr">
						$field.label
						{% if field.optional %}<span class="sub">${ "(optional)" | translate }</span>{% endif %}
						{% if field.help %}
						<span class="sub">
							<a href="{% admin "help&feather="~feather~"&field="~field.attr %}" target="_blank" class="help emblem"><img src="images/icons/help.png" alt="help" /></a>
						</span>
						{% endif %}
					</label>
					{% if field.type == "text" or field.type == "file" %}
					<input class="$field.type ${ field.classes | join(" ") }" type="$field.type" name="$field.attr" value="" id="$field.attr" />
					{% endif %}
					{% if field.type == "text_block" %}
					<textarea class="wide ${ field.classes | join(" ") }" rows="${ field.rows | fallback(12) }" name="$field.attr" id="$field.attr"></textarea>
					{% endif %}
				</p>
				{% endfor %}

				<br id="after_options" />
				<button type="submit" class="yay right" accesskey="s">
					<img src="images/icons/success.png" alt="success" />${ "Publish" | translate }
				</button>
				<button type="submit" name="draft" value="true" class="right">
					<img src="images/icons/save.png" alt="save" />${ "Save" | translate }
				</button>
				<button>
					${ "Preview" | translate }
				</button>

				<div class="clear" />
				<br class="js_disabled" />
				<div id="more_options" class="more_options js_disabled">
					{% if visitor.can.add_post %}
					<p>
						<label for="status">${ "Status" | translate }</label>
						<select name="status" id="status">
							<option value="public">${ "Public" | translate }</option>
							<option value="private">${ "Private" | translate }</option>
							<option value="registered_only">${ "Registered Only" | translate }</option>
						</select>
					</p>
					{% endif %}
					<p>
						<label for="pinned">${ "Pinned?" | translate }</label>
						<input type="checkbox" name="pinned" id="pinned" /> <small>${ "(shows this post above all others)" | translate }</small>
					</p>
					<p>
						<label for="slug">${ "Slug" | translate }</label>
						<input class="text" type="text" name="slug" value="" id="slug" />
					</p>
					<p>
						<label for="trackbacks">${ "Trackbacks" | translate }<span class="sub"> ${ "(comma separated)" | translate }</span></label>
						<input class="text" type="text" name="trackbacks" value="" id="trackbacks" />
					</p>
					<p>
						<label for="created_at">${ "Timestamp" | translate }</label>
						<input class="text" type="text" name="created_at" value="${ now | date }" id="created_at" />
						<input type="hidden" name="original_time" value="${ now | date }" />
					</p>
					{% trigger "new_post_options" %}
					<div class="clear"></div>
				</div>

				<input type="hidden" name="feather" value="${ feather | escape }" id="feather" />
				<input type="hidden" name="hash" value="$site.secure_hashkey" id="feather" />
			</form>
{% endblock %}
